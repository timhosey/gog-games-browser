Metadata-Version: 2.4
Name: gog-browser
Version: 0.1.0
Summary: Web browser for GOG game installers on your NAS
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: fastapi>=0.109.0
Requires-Dist: uvicorn[standard]>=0.27.0
Requires-Dist: httpx>=0.26.0
Requires-Dist: rarfile>=4.2
Requires-Dist: APScheduler>=3.10.0

# GOG Games Browser

A web app for browsing and organizing your GOG game installers stored on disk or NAS. It scans a directory for `setup_*.exe` (direct or inside `.rar` archives), fetches game details from GOG, and serves a simple UI with optional Discord notifications and scheduled scans.

## Features

- **Scanner**: Finds GOG installers (`setup_*.exe`) on the filesystem or inside `.rar` files (list-only, no extraction).
- **GOG metadata**: Resolves games by name (or override), fetches details from GOG APIs, and stores screenshots/videos in a metadata folder.
- **Web UI**: List games, filter, open detail, set GOG search name override, trigger “Refresh from GOG”.
- **Discord**: Optional webhook for events (scan started/finished, new games, removed games, errors).
- **Scheduler**: Optional daily (or cron) scan when `GOG_SCAN_SCHEDULE` is set.

## Environment variables

| Variable | Purpose |
|---------|--------|
| `GOG_INSTALLER_PATH` | Root path where installers live (directory with exe or .rar). |
| `GOG_METADATA_PATH` | Root path for metadata (game.json, screenshots, videos per game). |
| `GOG_SCAN_SCHEDULE` | Optional. Cron expression (e.g. `0 2 * * *`) or `daily` (2am). Empty = on-demand only. |
| `DISCORD_WEBHOOK_URL` | Optional. Discord webhook URL for scan events. |

## Run locally

1. **Python 3.10+** and **unrar** (or unrar-free) for RAR listing:
   - **Windows**: Install [UnRAR](https://www.rarlab.com/rar_add.htm) and add it to PATH.
   - **Linux**: `sudo apt-get install unrar-free` or `unrar`.
   - **macOS**: `brew install unrar`.

2. Install and run:

```bash
pip install -r requirements.txt
pip install -e .

export GOG_INSTALLER_PATH=/path/to/installers
export GOG_METADATA_PATH=/path/to/metadata
# optional: export GOG_SCAN_SCHEDULE=daily
# optional: export DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/...

python -m gog_browser.main
# or: uvicorn gog_browser.web.app:app --host 0.0.0.0 --port 8000
```

Open http://localhost:8000 .

## Docker

The image includes `unrar-free` for RAR listing. For full RAR support (e.g. solid archives), you may need an image that installs RARlab’s `unrar`.

**Build and run:**

```bash
docker build -t gog-browser .
docker run -p 8000:8000 \
  -e GOG_INSTALLER_PATH=/data/installers \
  -e GOG_METADATA_PATH=/data/metadata \
  -e GOG_SCAN_SCHEDULE=daily \
  -v /path/on/host/installers:/data/installers \
  -v /path/on/host/metadata:/data/metadata \
  gog-browser
```

**Docker Compose** (edit volumes to your paths):

```bash
docker-compose up -d
```

## API

- `GET /api/games` – List all games (installers + metadata).
- `GET /api/games/{id}` – Game detail by key.
- `POST /api/scan` – Trigger full scan.
- `PUT /api/games/{id}/override` – Set `gog_search_name` or `product_id` override.
- `POST /api/games/{id}/refresh` – Re-fetch game from GOG.
- `GET /api/metadata/{game_id}/{path}` – Serve stored assets (e.g. screenshots).

## License

MIT.
